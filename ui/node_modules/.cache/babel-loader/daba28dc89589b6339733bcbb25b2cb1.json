{"ast":null,"code":"import _objectSpread from\"/Users/cathyjung/Desktop/cathy/daml-PrivateNFT/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/cathyjung/Desktop/cathy/daml-PrivateNFT/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Users/cathyjung/Desktop/cathy/daml-PrivateNFT/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cathyjung/Desktop/cathy/daml-PrivateNFT/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from\"react\";import Table from\"@material-ui/core/Table\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import TableCell from\"@material-ui/core/TableCell\";import TableBody from\"@material-ui/core/TableBody\";import Button from\"@material-ui/core/Button\";import{useStreamQueries,useLedger,useParty}from\"@daml/react\";import{Asset}from\"@daml.js/daml-ui-template-0.0.1/lib/Main\";// import { Token }\nimport{InputDialog}from\"./InputDialog\";import useStyles from\"./styles\";import{getName,getParty}from\"../../config\";export default function Report(){var classes=useStyles();var party=useParty();var ledger=useLedger();var assets=useStreamQueries(Asset);var defaultGiveProps={open:false,title:\"Give Asset\",defaultValue:{newOwner:\"\"},fields:{newOwner:{label:\"New Owner\",type:\"selection\",items:[\"Alice\",\"Bob\"]}},onClose:function(){var _onClose=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:case\"end\":return _context.stop();}}},_callee);}));function onClose(){return _onClose.apply(this,arguments);}return onClose;}()};var _useState=useState(defaultGiveProps),_useState2=_slicedToArray(_useState,2),giveProps=_useState2[0],setGiveProps=_useState2[1];// One can pass the original contracts CreateEvent\nfunction showGive(asset){function onClose(_x){return _onClose2.apply(this,arguments);}function _onClose2(){_onClose2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(state){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setGiveProps(_objectSpread(_objectSpread({},defaultGiveProps),{},{open:false}));// if you want to use the contracts payload\nif(!(!state||asset.payload.owner===state.newOwner)){_context2.next=3;break;}return _context2.abrupt(\"return\");case 3:_context2.next=5;return ledger.exercise(Asset.Give,asset.contractId,{newOwner:getParty(state.newOwner)});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _onClose2.apply(this,arguments);};setGiveProps(_objectSpread(_objectSpread({},defaultGiveProps),{},{open:true,onClose:onClose}));};var today=new Date().toISOString().slice(0,10);var defaultAppraiseProps={open:false,title:\"Appraise Asset\",defaultValue:{newValue:\"0\"},fields:{newValue:{label:\"New Value\",type:\"number\"}},onClose:function(){var _onClose3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case\"end\":return _context3.stop();}}},_callee3);}));function onClose(){return _onClose3.apply(this,arguments);}return onClose;}()};var _useState3=useState(defaultAppraiseProps),_useState4=_slicedToArray(_useState3,2),appraiseProps=_useState4[0],setAppraiseProps=_useState4[1];// Or can pass just the ContractId of an\nfunction showAppraise(assetContractId){function onClose(_x2){return _onClose4.apply(this,arguments);}function _onClose4(){_onClose4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(state){var withNewDateOfAppraisal;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setAppraiseProps(_objectSpread(_objectSpread({},defaultAppraiseProps),{},{open:false}));if(state){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:withNewDateOfAppraisal=_objectSpread(_objectSpread({},state),{},{newDateOfAppraisal:today});_context4.next=6;return ledger.exercise(Asset.Appraise,assetContractId,withNewDateOfAppraisal);case 6:case\"end\":return _context4.stop();}}},_callee4);}));return _onClose4.apply(this,arguments);};setAppraiseProps(_objectSpread(_objectSpread({},defaultAppraiseProps),{},{open:true,onClose:onClose}));};var defaultNewAssetProps={open:false,title:\"New Asset\",defaultValue:{owner:party,name:\"\",dateOfAppraisal:today,value:\"0\"},fields:{owner:{label:\"Owner\",type:\"selection\",items:[\"Alice\",\"Bob\"]},name:{label:\"Name of Asset\",type:\"text\"},dateOfAppraisal:{label:\"Date of Appraisal\",type:\"date\"},value:{label:\"Value\",type:\"number\"}},onClose:function(){var _onClose5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:case\"end\":return _context5.stop();}}},_callee5);}));function onClose(){return _onClose5.apply(this,arguments);}return onClose;}()};var _useState5=useState(defaultNewAssetProps),_useState6=_slicedToArray(_useState5,2),newAssetProps=_useState6[0],setNewAssetProps=_useState6[1];function showNewAsset(){function onClose(_x3){return _onClose6.apply(this,arguments);}function _onClose6(){_onClose6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(state){var withIssuer;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setNewAssetProps(_objectSpread(_objectSpread({},defaultNewAssetProps),{},{open:false}));if(state){_context6.next=3;break;}return _context6.abrupt(\"return\");case 3:withIssuer=_objectSpread(_objectSpread({},state),{},{issuer:party,owner:getParty(state.owner)});_context6.next=6;return ledger.create(Asset,withIssuer);case 6:case\"end\":return _context6.stop();}}},_callee6);}));return _onClose6.apply(this,arguments);};setNewAssetProps(_objectSpread(_objectSpread({},defaultNewAssetProps),{},{open:true,onClose:onClose}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(InputDialog,giveProps),/*#__PURE__*/React.createElement(InputDialog,appraiseProps),/*#__PURE__*/React.createElement(InputDialog,newAssetProps),/*#__PURE__*/React.createElement(Button,{color:\"primary\",size:\"small\",className:classes.choiceButton,variant:\"contained\",onClick:function onClick(){return showNewAsset();}},\"Create New Asset\"),/*#__PURE__*/React.createElement(Table,{size:\"small\"},/*#__PURE__*/React.createElement(TableHead,null,/*#__PURE__*/React.createElement(TableRow,{className:classes.tableRow},/*#__PURE__*/React.createElement(TableCell,{key:0,className:classes.tableCell},\"Issuer\"),/*#__PURE__*/React.createElement(TableCell,{key:1,className:classes.tableCell},\"Owner\"),/*#__PURE__*/React.createElement(TableCell,{key:2,className:classes.tableCell},\"Name\"),/*#__PURE__*/React.createElement(TableCell,{key:3,className:classes.tableCell},\"Value\"),/*#__PURE__*/React.createElement(TableCell,{key:4,className:classes.tableCell},\"DateOfAppraisal\"),/*#__PURE__*/React.createElement(TableCell,{key:5,className:classes.tableCell},\"Give\"),/*#__PURE__*/React.createElement(TableCell,{key:6,className:classes.tableCell},\"Appraise\"))),/*#__PURE__*/React.createElement(TableBody,null,assets.contracts.map(function(a){return/*#__PURE__*/React.createElement(TableRow,{key:a.contractId,className:classes.tableRow},/*#__PURE__*/React.createElement(TableCell,{key:0,className:classes.tableCell},getName(a.payload.issuer)),/*#__PURE__*/React.createElement(TableCell,{key:1,className:classes.tableCell},getName(a.payload.owner)),/*#__PURE__*/React.createElement(TableCell,{key:2,className:classes.tableCell},a.payload.name),/*#__PURE__*/React.createElement(TableCell,{key:3,className:classes.tableCell},a.payload.value),/*#__PURE__*/React.createElement(TableCell,{key:4,className:classes.tableCell},a.payload.dateOfAppraisal),/*#__PURE__*/React.createElement(TableCell,{key:5,className:classes.tableCellButton},/*#__PURE__*/React.createElement(Button,{color:\"primary\",size:\"small\",className:classes.choiceButton,variant:\"contained\",disabled:a.payload.owner!==party,onClick:function onClick(){return showGive(a);}},\"Give\")),/*#__PURE__*/React.createElement(TableCell,{key:6,className:classes.tableCellButton},/*#__PURE__*/React.createElement(Button,{color:\"primary\",size:\"small\",className:classes.choiceButton,variant:\"contained\",disabled:a.payload.issuer!==party,onClick:function onClick(){return showAppraise(a.contractId);}},\"Appraise\")));}))));}","map":{"version":3,"sources":["/Users/cathyjung/Desktop/cathy/daml-PrivateNFT/ui/src/pages/report/Report.tsx"],"names":["React","useState","Table","TableHead","TableRow","TableCell","TableBody","Button","useStreamQueries","useLedger","useParty","Asset","InputDialog","useStyles","getName","getParty","Report","classes","party","ledger","assets","defaultGiveProps","open","title","defaultValue","newOwner","fields","label","type","items","onClose","giveProps","setGiveProps","showGive","asset","state","payload","owner","exercise","Give","contractId","today","Date","toISOString","slice","defaultAppraiseProps","newValue","appraiseProps","setAppraiseProps","showAppraise","assetContractId","withNewDateOfAppraisal","newDateOfAppraisal","Appraise","defaultNewAssetProps","name","dateOfAppraisal","value","newAssetProps","setNewAssetProps","showNewAsset","withIssuer","issuer","create","choiceButton","tableRow","tableCell","contracts","map","a","tableCellButton"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Table from \"@material-ui/core/Table\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport Button from \"@material-ui/core/Button\";\nimport Ledger from \"@daml/ledger\";\nimport { useStreamQueries, useLedger, useParty } from \"@daml/react\";\nimport { ContractId } from \"@daml/types\";\nimport { Appraise, Asset, Give  } from \"@daml.js/daml-ui-template-0.0.1/lib/Main\";\n// import { Token }\nimport { InputDialog, InputDialogProps } from \"./InputDialog\";\nimport useStyles from \"./styles\";\nimport { getName, getParty } from \"../../config\";\n\nexport default function Report() {\n  const classes = useStyles();\n  const party = useParty();\n  const ledger : Ledger = useLedger();\n  const assets = useStreamQueries(Asset);\n\n  const defaultGiveProps : InputDialogProps<Give> = {\n    open: false,\n    title: \"Give Asset\",\n    defaultValue: { newOwner : \"\" },\n    fields: {\n      newOwner : {\n        label: \"New Owner\",\n        type: \"selection\",\n        items: [ \"Alice\", \"Bob\" ] } },\n    onClose: async function() {}\n  };\n\n  const [ giveProps, setGiveProps ] = useState(defaultGiveProps);\n  // One can pass the original contracts CreateEvent\n  function showGive(asset : Asset.CreateEvent) {\n    async function onClose(state : Give | null) {\n      setGiveProps({ ...defaultGiveProps, open: false});\n      // if you want to use the contracts payload\n      if (!state || asset.payload.owner === state.newOwner) return;\n      await ledger.exercise(Asset.Give, asset.contractId, { newOwner: getParty(state.newOwner) } );\n    };\n    setGiveProps({ ...defaultGiveProps, open: true, onClose})\n  };\n\n  type UserSpecifiedAppraise = Pick<Appraise, \"newValue\">;\n  const today = (new Date()).toISOString().slice(0,10);\n  const defaultAppraiseProps : InputDialogProps<UserSpecifiedAppraise> = {\n    open: false,\n    title: \"Appraise Asset\",\n    defaultValue: { newValue: \"0\" },\n    fields: {\n      newValue : {\n        label: \"New Value\",\n        type: \"number\" }\n      },\n    onClose: async function() {}\n  };\n  const [ appraiseProps, setAppraiseProps ] = useState(defaultAppraiseProps);\n\n  // Or can pass just the ContractId of an\n  function showAppraise(assetContractId : ContractId<Asset>) {\n    async function onClose(state : UserSpecifiedAppraise | null) {\n      setAppraiseProps({ ...defaultAppraiseProps, open: false});\n      if (!state) return;\n      const withNewDateOfAppraisal = { ...state, newDateOfAppraisal:today};\n      await ledger.exercise(Asset.Appraise, assetContractId, withNewDateOfAppraisal);\n    };\n    setAppraiseProps({...defaultAppraiseProps, open: true, onClose});\n  };\n\n  type InputFieldsForNewAsset = Omit<Asset, \"issuer\">;\n  const defaultNewAssetProps : InputDialogProps<InputFieldsForNewAsset> = {\n    open: false,\n    title: \"New Asset\",\n    defaultValue: {\n      owner: party,\n      name: \"\",\n      dateOfAppraisal: today,\n      value: \"0\",\n    },\n    fields: {\n      owner: {\n        label: \"Owner\",\n        type: \"selection\",\n        items: [ \"Alice\", \"Bob\" ],\n      },\n      name: {\n        label: \"Name of Asset\",\n        type: \"text\"\n      },\n      dateOfAppraisal: {\n        label: \"Date of Appraisal\",\n        type: \"date\"\n      },\n      value: {\n        label: \"Value\",\n        type: \"number\"\n      }\n    },\n    onClose: async function() {}\n  };\n  const [newAssetProps, setNewAssetProps] = useState(defaultNewAssetProps);\n  function showNewAsset() {\n    async function onClose(state : InputFieldsForNewAsset | null) {\n      setNewAssetProps({ ...defaultNewAssetProps, open: false});\n      if (!state) return;\n      const withIssuer = { ...state, issuer: party, owner: getParty(state.owner) };\n      await ledger.create(Asset, withIssuer);\n    };\n    setNewAssetProps({...defaultNewAssetProps, open: true, onClose});\n  };\n\n  return (\n    <>\n      <InputDialog { ...giveProps } />\n      <InputDialog { ...appraiseProps } />\n      <InputDialog { ...newAssetProps } />\n      <Button color=\"primary\" size=\"small\" className={classes.choiceButton} variant=\"contained\" onClick={() => showNewAsset()}>\n        Create New Asset\n      </Button>\n      <Table size=\"small\">\n        <TableHead>\n          <TableRow className={classes.tableRow}>\n            <TableCell key={0} className={classes.tableCell}>Issuer</TableCell>\n            <TableCell key={1} className={classes.tableCell}>Owner</TableCell>\n            <TableCell key={2} className={classes.tableCell}>Name</TableCell>\n            <TableCell key={3} className={classes.tableCell}>Value</TableCell>\n            <TableCell key={4} className={classes.tableCell}>DateOfAppraisal</TableCell>\n            <TableCell key={5} className={classes.tableCell}>Give</TableCell>\n            <TableCell key={6} className={classes.tableCell}>Appraise</TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          {assets.contracts.map(a => (\n            <TableRow key={a.contractId} className={classes.tableRow}>\n              <TableCell key={0} className={classes.tableCell}>{getName(a.payload.issuer)}</TableCell>\n              <TableCell key={1} className={classes.tableCell}>{getName(a.payload.owner)}</TableCell>\n              <TableCell key={2} className={classes.tableCell}>{a.payload.name}</TableCell>\n              <TableCell key={3} className={classes.tableCell}>{a.payload.value}</TableCell>\n              <TableCell key={4} className={classes.tableCell}>{a.payload.dateOfAppraisal}</TableCell>\n              <TableCell key={5} className={classes.tableCellButton}>\n                <Button color=\"primary\" size=\"small\" className={classes.choiceButton} variant=\"contained\" disabled={a.payload.owner !== party} onClick={() => showGive(a)}>Give</Button>\n              </TableCell>\n              <TableCell key={6} className={classes.tableCellButton}>\n                <Button color=\"primary\" size=\"small\" className={classes.choiceButton} variant=\"contained\" disabled={a.payload.issuer !== party} onClick={() => showAppraise(a.contractId)}>Appraise</Button>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}